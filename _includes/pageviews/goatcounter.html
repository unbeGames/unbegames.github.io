<!-- Display GoatCounter pageviews -->
<script>
  let pv = document.getElementById('pageviews');

  if (pv !== null) {
    const uri = location.pathname.replace(/\/$/, '');
    const url = `https://{{ site.analytics.goatcounter.id }}/counter/${encodeURIComponent(uri)}.json`;

    fetch(url)
      .then(
        (response) => response.json(),
        (error) => { 
            console.log(error); // Never executes because the Promise is resolved
      })
      .then((data) => {
        const count = data.count.replace(/\s/g, '');
        pv.innerText = new Intl.NumberFormat().format(count);
      })
      .catch((error) => {
        console.log(error);
        pv.innerText = '1';
      });
  }
</script>
